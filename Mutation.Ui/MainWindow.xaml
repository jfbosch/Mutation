<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Mutation.Ui.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Mutation.Ui"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Mutation">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid Background="{ThemeResource AppBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="6*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="1" Margin="32,24,32,12" Spacing="4">
                <TextBlock Text="Mutation Workspace" Style="{StaticResource TitleTextStyle}" AutomationProperties.Name="Application Title" />
                <TextBlock Text="Capture ideas, format transcripts, and automate workflows from one polished surface." Style="{StaticResource SubtitleTextStyle}" />
            </StackPanel>
        </Grid>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="6*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ScrollViewer
                Grid.Column="1"
                Padding="32,0,32,32"
                HorizontalAlignment="Stretch"
                HorizontalScrollBarVisibility="Disabled"
                VerticalScrollBarVisibility="Auto"
                VerticalScrollMode="Auto">
                <StackPanel x:Name="ContentStack" Spacing="20">
                <Grid x:Name="StatusRegion" MinHeight="72">
                    <InfoBar
                        x:Name="StatusInfoBar"
                        Title="Status"
                        IsOpen="False"
                        AutomationProperties.Name="Status notifications"
                        AutomationProperties.LiveSetting="Polite"
                        AutomationProperties.HelpText="Latest status messages for Mutation workspace" />
                </Grid>

                <Grid x:Name="ContentGrid" ColumnSpacing="18" RowSpacing="18">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition x:Name="PrimaryColumn" Width="*" />
                        <ColumnDefinition x:Name="SecondaryColumn" Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Grid.Transitions>
                        <TransitionCollection>
                            <EntranceThemeTransition FromHorizontalOffset="48" />
                        </TransitionCollection>
                    </Grid.Transitions>

                    <!-- Microphone Management -->
                    <Border x:Name="MicrophoneCard" Style="{StaticResource CardStyle}" Grid.Row="0" Grid.Column="0">
                        <StackPanel Spacing="16">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Microphone" Style="{StaticResource SectionHeaderTextStyle}" />
                                <TextBlock Text="Select your preferred capture device and control mute states instantly." Style="{StaticResource CaptionTextStyle}" />
                            </StackPanel>

                            <Grid ColumnSpacing="16" RowSpacing="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Spacing="6">
                                    <TextBlock x:Name="LblMicrophone" Text="Microphone device" Style="{StaticResource CaptionTextStyle}" />
                                    <Grid ColumnSpacing="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid Width="28" Height="28" VerticalAlignment="Center">
                                            <FontIcon
                                                x:Name="MicStatusIcon"
                                                Glyph="&#xE720;"
                                                FontFamily="Segoe Fluent Icons"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center" />
                                            <Rectangle
                                                x:Name="MicStatusIconSlash"
                                                Width="20"
                                                Height="2"
                                                RadiusX="1"
                                                RadiusY="1"
                                                Fill="{Binding Foreground, ElementName=MicStatusIcon}"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Visibility="Collapsed"
                                                IsHitTestVisible="False"
                                                RenderTransformOrigin="0.5,0.5">
                                                <Rectangle.RenderTransform>
                                                    <CompositeTransform Rotation="-45" />
                                                </Rectangle.RenderTransform>
                                            </Rectangle>
                                        </Grid>
                                        <ComboBox
                                            x:Name="CmbMicrophone"
                                            Grid.Column="1"
                                            PlaceholderText="Select a microphone"
                                            HorizontalAlignment="Stretch"
                                            AutomationProperties.LabeledBy="{Binding ElementName=LblMicrophone}"
                                            AutomationProperties.Name="Microphone selection"
                                            ToolTipService.ToolTip="Choose the input microphone"
                                            SelectionChanged="CmbMicrophone_SelectionChanged" />
                                    </Grid>
                                </StackPanel>

                                <Button
                                    x:Name="BtnToggleMic"
                                    Grid.Column="1"
                                    Style="{StaticResource AccentButtonStyle}"
                                    Click="BtnToggleMic_Click"
                                    AccessKey="M"
                                    AutomationProperties.Name="Toggle microphone"
                                    ToolTipService.ToolTip="Toggle microphone mute state">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <Grid Width="28" Height="28">
                                            <FontIcon
                                                x:Name="BtnToggleMicIcon"
                                                Glyph="&#xE720;"
                                                FontFamily="Segoe Fluent Icons"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                            />
                                            <Rectangle
                                                x:Name="BtnToggleMicSlash"
                                                Width="20"
                                                Height="2"
                                                RadiusX="1"
                                                RadiusY="1"
                                                Fill="{Binding Foreground, ElementName=BtnToggleMicIcon}"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Visibility="Collapsed"
                                                IsHitTestVisible="False"
                                                RenderTransformOrigin="0.5,0.5">
                                                <Rectangle.RenderTransform>
                                                    <CompositeTransform Rotation="-45" />
                                                </Rectangle.RenderTransform>
                                            </Rectangle>
                                        </Grid>
                                        <StackPanel Spacing="2">
                                            <TextBlock x:Name="BtnToggleMicLabel" Text="Mute microphone" />
                                            <TextBlock
                                                x:Name="BtnToggleMicHotkey"
                                                Text="Hotkey: ALT+Q"
                                                Style="{StaticResource CaptionTextStyle}"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Speech to Text -->
                    <Border x:Name="SpeechCard" Style="{StaticResource CardStyle}" Grid.Row="0" Grid.Column="1">
                        <StackPanel Spacing="18">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Speech to Text" Style="{StaticResource SectionHeaderTextStyle}" />
                                <TextBlock Text="Choose a service and record clear transcripts with responsive controls." Style="{StaticResource CaptionTextStyle}" />
                            </StackPanel>

                            <Grid ColumnSpacing="16" RowSpacing="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Spacing="6">
                                    <TextBlock x:Name="LblSpeechService" Text="Speech service" Style="{StaticResource CaptionTextStyle}" />
                                    <ComboBox
                                        x:Name="CmbSpeechService"
                                        PlaceholderText="Select a speech-to-text service"
                                        AutomationProperties.LabeledBy="{Binding ElementName=LblSpeechService}"
                                        AutomationProperties.Name="Speech-to-text service selection"
                                        ToolTipService.ToolTip="Pick the transcription engine"
                                        SelectionChanged="CmbSpeechService_SelectionChanged" />
                                </StackPanel>

                                <Button
                                    x:Name="BtnSpeechToText"
                                    Grid.Column="1"
                                    Style="{StaticResource AccentButtonStyle}"
                                    Click="BtnSpeechToText_Click"
                                    AccessKey="R"
                                    AutomationProperties.Name="Start recording"
                                    ToolTipService.ToolTip="Start or stop speech capture">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon
                                            x:Name="BtnSpeechToTextIcon"
                                            Glyph="&#xE768;"
                                            FontFamily="Segoe Fluent Icons"
                                        />
                                        <StackPanel Spacing="2">
                                            <TextBlock x:Name="BtnSpeechToTextLabel" Text="Start recording" />
                                            <TextBlock
                                                x:Name="BtnSpeechToTextHotkey"
                                                Text="Hotkey: SHIFT+ALT+U"
                                                Style="{StaticResource CaptionTextStyle}"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Speech Transcript -->
                    <Border x:Name="SpeechTranscriptCard" Style="{StaticResource CardStyle}" Grid.Row="1" Grid.ColumnSpan="2">
                        <StackPanel Spacing="12">
                            <TextBlock Text="Transcript" Style="{StaticResource CaptionTextStyle}" />
                            <TextBox
                                x:Name="TxtSpeechToText"
                                MinHeight="140"
                                TextWrapping="Wrap"
                                AcceptsReturn="True"
                                AutomationProperties.Name="Speech to text transcript"
                                ToolTipService.ToolTip="Raw transcript generated from speech"
                                TextChanged="TxtSpeechToText_TextChanged" />
                        </StackPanel>
                    </Border>

                    <!-- Formatting & Automation -->
                    <Border x:Name="FormattingCard" Style="{StaticResource CardStyle}" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
                        <StackPanel Spacing="18">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Formatting &amp; Automation" Style="{StaticResource SectionHeaderTextStyle}" />
                                <TextBlock Text="Control how transcripts are refined and where results are delivered." Style="{StaticResource CaptionTextStyle}" />
                            </StackPanel>

                            <Grid ColumnSpacing="16" RowSpacing="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Spacing="6">
                                    <TextBlock x:Name="LblThirdPartyInteraction" Text="Third-party interaction" Style="{StaticResource CaptionTextStyle}" />
                                    <ComboBox
                                        x:Name="CmbInsertOption"
                                        PlaceholderText="Select an automation option"
                                        AutomationProperties.LabeledBy="{Binding ElementName=LblThirdPartyInteraction}"
                                        AutomationProperties.Name="Third-party interaction mode"
                                        ToolTipService.ToolTip="Choose how formatted text is inserted"
                                        SelectionChanged="CmbInsertOption_SelectionChanged" />
                                    <TextBlock
                                        x:Name="ThirdPartyExplanationText"
                                        TextWrapping="Wrap"
                                        Style="{StaticResource CaptionTextStyle}"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                </StackPanel>

                                <StackPanel Grid.Column="1" Spacing="6">
                                    <TextBlock Text="Format prompt" Style="{StaticResource CaptionTextStyle}" />
                                    <TextBox
                                        x:Name="TxtFormatPrompt"
                                        PlaceholderText="Add optional guidance for LLM formatting"
                                        AcceptsReturn="True"
                                        MinHeight="88"
                                        TextWrapping="Wrap"
                                        AutomationProperties.Name="Format prompt"
                                        ToolTipService.ToolTip="Prompt used for large language model formatting" />
                                </StackPanel>
                            </Grid>

                            <StackPanel x:Name="FormattingActionsPanel" Orientation="Horizontal" Spacing="12" HorizontalAlignment="Stretch">
                                <Button
                                    x:Name="BtnFormatTranscript"
                                    Style="{StaticResource AccentButtonStyle}"
                                    Click="BtnFormatTranscript_Click"
                                    AccessKey="F"
                                    AutomationProperties.Name="Format transcript"
                                    ToolTipService.ToolTip="Apply local formatting rules to the transcript">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE8A1;" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="Format transcript" />
                                    </StackPanel>
                                </Button>

                                <Button
                                    x:Name="BtnFormatLlm"
                                    Style="{StaticResource OutlinedButtonStyle}"
                                    Click="BtnFormatLlm_Click"
                                    AccessKey="L"
                                    AutomationProperties.Name="Format transcript with LLM"
                                    ToolTipService.ToolTip="Send transcript through the configured language model">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE8FD;" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="LLM formatting" />
                                    </StackPanel>
                                </Button>
                            </StackPanel>

                            <TextBox
                                x:Name="TxtFormatTranscript"
                                MinHeight="140"
                                TextWrapping="Wrap"
                                AcceptsReturn="True"
                                AutomationProperties.Name="Formatted transcript"
                                ToolTipService.ToolTip="Formatted transcript ready for sharing" />
                        </StackPanel>
                    </Border>

                    <!-- Capture & OCR -->
                    <Border x:Name="CaptureCard" Style="{StaticResource CardStyle}" Grid.Row="3" Grid.Column="0">
                        <StackPanel Spacing="18">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Visual Capture" Style="{StaticResource SectionHeaderTextStyle}" />
                                <TextBlock Text="Quickly capture the screen and extract text with OCR." Style="{StaticResource CaptionTextStyle}" />
                            </StackPanel>

                            <StackPanel Spacing="12">
                                <Button
                                    x:Name="BtnScreenshot"
                                    Style="{StaticResource OutlinedButtonStyle}"
                                    Click="BtnScreenshot_Click"
                                    AccessKey="S"
                                    AutomationProperties.Name="Screenshot to clipboard"
                                    ToolTipService.ToolTip="Copy a screenshot directly to the clipboard">
                                    <Grid ColumnSpacing="12" VerticalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="32" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <FontIcon
                                            Glyph="&#xE70F;"
                                            FontFamily="Segoe Fluent Icons"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center" />
                                        <StackPanel Grid.Column="1" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="Screenshot to clipboard" />
                                            <TextBlock
                                                x:Name="BtnScreenshotHotkey"
                                                Text="Hotkey: SHIFT+ALT+K"
                                                Style="{StaticResource CaptionTextStyle}"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                    </Grid>
                                </Button>

                                <Button
                                    x:Name="BtnOcrClipboard"
                                    Style="{StaticResource OutlinedButtonStyle}"
                                    Click="BtnOcrClipboard_Click"
                                    AccessKey="C"
                                    AutomationProperties.Name="OCR clipboard"
                                    ToolTipService.ToolTip="Run OCR on an image stored in the clipboard">
                                    <Grid ColumnSpacing="12" VerticalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="32" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <FontIcon
                                            Glyph="&#xE8F1;"
                                            FontFamily="Segoe Fluent Icons"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center" />
                                        <StackPanel Grid.Column="1" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="OCR clipboard" />
                                            <TextBlock
                                                x:Name="BtnOcrClipboardHotkey"
                                                Text="Hotkey: ALT+J"
                                                Style="{StaticResource CaptionTextStyle}"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                    </Grid>
                                </Button>

                                <Button
                                    x:Name="BtnOcrClipboardLrtb"
                                    Style="{StaticResource OutlinedButtonStyle}"
                                    Click="BtnOcrClipboardLrtb_Click"
                                    AccessKey="D"
                                    AutomationProperties.Name="OCR clipboard left to right"
                                    ToolTipService.ToolTip="Run OCR on an image stored in the clipboard using left-to-right reading order">
                                    <Grid ColumnSpacing="12" VerticalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="32" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <FontIcon
                                            Glyph="&#xE8F1;"
                                            FontFamily="Segoe Fluent Icons"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center" />
                                        <StackPanel Grid.Column="1" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="OCR clipboard (L→R)" />
                                            <TextBlock
                                                x:Name="BtnOcrClipboardLrtbHotkey"
                                                Text="Hotkey: ALT+K"
                                                Style="{StaticResource CaptionTextStyle}"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                    </Grid>
                                </Button>

                                <Button
                                    x:Name="BtnScreenshotOcr"
                                    Style="{StaticResource OutlinedButtonStyle}"
                                    Click="BtnScreenshotOcr_Click"
                                    AccessKey="O"
                                    AutomationProperties.Name="Screenshot and OCR"
                                    ToolTipService.ToolTip="Capture a screenshot and extract text automatically">
                                    <Grid ColumnSpacing="12" VerticalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="32" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <FontIcon
                                            Glyph="&#xE8D2;"
                                            FontFamily="Segoe Fluent Icons"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center" />
                                        <StackPanel Grid.Column="1" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="Screenshot &amp; OCR" />
                                            <TextBlock
                                                x:Name="BtnScreenshotOcrHotkey"
                                                Text="Hotkey: SHIFT+ALT+J"
                                                Style="{StaticResource CaptionTextStyle}"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                    </Grid>
                                </Button>

                                <Button
                                    x:Name="BtnScreenshotOcrLrtb"
                                    Style="{StaticResource OutlinedButtonStyle}"
                                    Click="BtnScreenshotOcrLrtb_Click"
                                    AccessKey="B"
                                    AutomationProperties.Name="Screenshot and OCR left to right"
                                    ToolTipService.ToolTip="Capture a screenshot and extract text using left-to-right reading order">
                                    <Grid ColumnSpacing="12" VerticalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="32" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <FontIcon
                                            Glyph="&#xE8D2;"
                                            FontFamily="Segoe Fluent Icons"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center" />
                                        <StackPanel Grid.Column="1" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="Screenshot &amp; OCR (L→R)" />
                                            <TextBlock
                                                x:Name="BtnScreenshotOcrLrtbHotkey"
                                                Text="Hotkey: SHIFT+ALT+E"
                                                Style="{StaticResource CaptionTextStyle}"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        </StackPanel>
                                    </Grid>
                                </Button>
                            </StackPanel>

                            <TextBox
                                x:Name="TxtOcr"
                                MinHeight="120"
                                AcceptsReturn="True"
                                TextWrapping="Wrap"
                                AutomationProperties.Name="OCR result"
                                ToolTipService.ToolTip="Text extracted from captured images" />
                        </StackPanel>
                    </Border>

                    <!-- Clipboard & Voice -->
                    <Border x:Name="ClipboardCard" Style="{StaticResource CardStyle}" Grid.Row="3" Grid.Column="1">
                        <StackPanel Spacing="18">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Clipboard &amp; Voice" Style="{StaticResource SectionHeaderTextStyle}" />
                                <TextBlock Text="Manage clipboard content and play it aloud when needed." Style="{StaticResource CaptionTextStyle}" />
                            </StackPanel>

                            <StackPanel Spacing="12">
                                <TextBox
                                    x:Name="TxtClipboard"
                                    PlaceholderText="Clipboard text"
                                    AcceptsReturn="True"
                                    MinHeight="88"
                                    TextWrapping="Wrap"
                                    AutomationProperties.Name="Clipboard text"
                                    ToolTipService.ToolTip="Text that will be copied or spoken" />

                                <StackPanel x:Name="ClipboardActionsPanel" Orientation="Horizontal" Spacing="12">
                                    <Button
                                        x:Name="BtnCopyText"
                                        Style="{StaticResource AccentButtonStyle}"
                                        Click="CopyText_Click"
                                        AccessKey="P"
                                        AutomationProperties.Name="Copy clipboard text"
                                        ToolTipService.ToolTip="Copy the clipboard text to the system clipboard">
                                        <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                            <FontIcon Glyph="&#xE8C8;" FontFamily="Segoe Fluent Icons" />
                                            <TextBlock Text="Copy text" />
                                        </StackPanel>
                                    </Button>

                                    <Button
                                        x:Name="BtnTextToSpeech"
                                        Style="{StaticResource OutlinedButtonStyle}"
                                        Click="BtnTextToSpeech_Click"
                                        AccessKey="T"
                                        AutomationProperties.Name="Speak clipboard text"
                                        ToolTipService.ToolTip="Play the clipboard text using text-to-speech">
                                        <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                            <FontIcon Glyph="&#xE76E;" FontFamily="Segoe Fluent Icons" />
                                            <StackPanel Spacing="2">
                                                <TextBlock Text="Speak clipboard" />
                                                <TextBlock
                                                    x:Name="BtnTextToSpeechHotkey"
                                                    Text="Hotkey: CTRL+SHIFT+Q"
                                                    Style="{StaticResource CaptionTextStyle}"
                                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>

                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroup>
                        <VisualState x:Name="Narrow">
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="0" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="SecondaryColumn.Width" Value="0*" />
                                <Setter Target="MicrophoneCard.(Grid.ColumnSpan)" Value="2" />
                                <Setter Target="SpeechCard.(Grid.Column)" Value="0" />
                                <Setter Target="SpeechCard.(Grid.Row)" Value="1" />
                                <Setter Target="SpeechCard.(Grid.ColumnSpan)" Value="2" />
                                <Setter Target="SpeechTranscriptCard.(Grid.Row)" Value="2" />
                                <Setter Target="FormattingCard.(Grid.Row)" Value="3" />
                                <Setter Target="FormattingCard.(Grid.ColumnSpan)" Value="2" />
                                <Setter Target="CaptureCard.(Grid.Column)" Value="0" />
                                <Setter Target="CaptureCard.(Grid.Row)" Value="4" />
                                <Setter Target="CaptureCard.(Grid.ColumnSpan)" Value="2" />
                                <Setter Target="ClipboardCard.(Grid.Column)" Value="0" />
                                <Setter Target="ClipboardCard.(Grid.Row)" Value="5" />
                                <Setter Target="ClipboardCard.(Grid.ColumnSpan)" Value="2" />
                                <Setter Target="FormattingActionsPanel.Orientation" Value="Vertical" />
                                <Setter Target="ClipboardActionsPanel.Orientation" Value="Vertical" />
                            </VisualState.Setters>
                        </VisualState>
                        <VisualState x:Name="Wide">
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="900" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="SecondaryColumn.Width" Value="*" />
                                <Setter Target="MicrophoneCard.(Grid.ColumnSpan)" Value="1" />
                                <Setter Target="SpeechCard.(Grid.Column)" Value="1" />
                                <Setter Target="SpeechCard.(Grid.Row)" Value="0" />
                                <Setter Target="SpeechCard.(Grid.ColumnSpan)" Value="1" />
                                <Setter Target="SpeechTranscriptCard.(Grid.Row)" Value="1" />
                                <Setter Target="FormattingCard.(Grid.Row)" Value="2" />
                                <Setter Target="FormattingCard.(Grid.ColumnSpan)" Value="2" />
                                <Setter Target="CaptureCard.(Grid.Column)" Value="0" />
                                <Setter Target="CaptureCard.(Grid.ColumnSpan)" Value="1" />
                                <Setter Target="CaptureCard.(Grid.Row)" Value="3" />
                                <Setter Target="ClipboardCard.(Grid.Column)" Value="1" />
                                <Setter Target="ClipboardCard.(Grid.ColumnSpan)" Value="1" />
                                <Setter Target="ClipboardCard.(Grid.Row)" Value="3" />
                                <Setter Target="FormattingActionsPanel.Orientation" Value="Horizontal" />
                                <Setter Target="ClipboardActionsPanel.Orientation" Value="Horizontal" />
                            </VisualState.Setters>
                        </VisualState>
                    </VisualStateGroup>
                </VisualStateManager.VisualStateGroups>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Grid>
</Window>
