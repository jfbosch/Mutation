<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Mutation.Ui.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Mutation.Ui"
    xmlns:datagrid="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Mutation Assistant"
    MinHeight="600"
    MinWidth="640"
    Background="{StaticResource SurfaceBrush}">

    <Window.SystemBackdrop>
        <MicaBackdrop Kind="BaseAlt" />
    </Window.SystemBackdrop>

    <Grid Background="{StaticResource SurfaceBrush}" RowSpacing="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="24,24,24,0" Spacing="8">
            <TextBlock Text="Mutation Assistant" FontSize="32" FontWeight="SemiBold" />
            <TextBlock Text="Capture audio, refine transcripts, and automate your workflow with a refreshed experience." Style="{StaticResource SubHeaderTextStyle}" />
        </StackPanel>

        <ScrollViewer Grid.Row="1" Padding="24" VerticalScrollBarVisibility="Auto">
            <ScrollViewer.Transitions>
                <TransitionCollection>
                    <EntranceThemeTransition />
                </TransitionCollection>
            </ScrollViewer.Transitions>
            <StackPanel Spacing="24">
                <StackPanel x:Name="StatusPanel" Spacing="12">
                    <muxc:InfoBar
                        x:Name="SuccessInfoBar"
                        Style="{StaticResource StatusInfoBarStyle}"
                        Title="Success"
                        Severity="Success"
                        Message="Everything is ready to go."
                        IsOpen="False"
                        AutomationProperties.Name="Success notification" />
                    <muxc:InfoBar
                        x:Name="WarningInfoBar"
                        Style="{StaticResource StatusInfoBarStyle}"
                        Title="Warning"
                        Severity="Warning"
                        Message="Something may need your attention."
                        IsOpen="False"
                        AutomationProperties.Name="Warning notification" />
                    <muxc:InfoBar
                        x:Name="ErrorInfoBar"
                        Style="{StaticResource StatusInfoBarStyle}"
                        Title="Error"
                        Severity="Error"
                        Message="A problem occurred. Try again or adjust your settings."
                        IsOpen="False"
                        AutomationProperties.Name="Error notification" />
                </StackPanel>

                <Grid
                    x:Name="ContentGrid"
                    ColumnSpacing="24"
                    RowSpacing="24"
                    MaxWidth="1100"
                    HorizontalAlignment="Center">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition x:Name="PrimaryColumn" Width="*" />
                        <ColumnDefinition x:Name="SecondaryColumn" Width="*" />
                    </Grid.ColumnDefinitions>

                    <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource CardBorderStyle}">
                        <Border.Transitions>
                            <TransitionCollection>
                                <EntranceThemeTransition />
                            </TransitionCollection>
                        </Border.Transitions>
                        <StackPanel Spacing="16">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <FontIcon Glyph="&#xE720;" FontSize="24" Foreground="{StaticResource PrimaryBrush}" />
                                <StackPanel>
                                    <TextBlock Text="Audio capture" Style="{StaticResource SectionHeaderTextStyle}" />
                                    <TextBlock Text="Control your microphone and turn speech into text." Style="{StaticResource SubHeaderTextStyle}" />
                                </StackPanel>
                            </StackPanel>

                            <ComboBox
                                x:Name="CmbMicrophone"
                                Header="Microphone"
                                PlaceholderText="Select a microphone"
                                SelectionChanged="CmbMicrophone_SelectionChanged"
                                AutomationProperties.Name="Microphone selection"
                                AutomationProperties.HelpText="Choose which microphone to capture audio from." />

                            <Button
                                x:Name="BtnToggleMic"
                                Click="BtnToggleMic_Click"
                                AccessKey="M"
                                MinWidth="160"
                                AutomationProperties.Name="Toggle microphone mute"
                                AutomationProperties.HelpText="Mute or unmute the selected microphone.">
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                    <FontIcon Glyph="&#xF131;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                    <TextBlock Text="Toggle mute" />
                                </StackPanel>
                                <ToolTipService.ToolTip>
                                    <ToolTip Content="Mute or unmute the microphone (Alt+M)" />
                                </ToolTipService.ToolTip>
                            </Button>

                            <ComboBox
                                x:Name="CmbSpeechService"
                                Header="Speech-to-text service"
                                PlaceholderText="Select a provider"
                                SelectionChanged="CmbSpeechService_SelectionChanged"
                                AutomationProperties.Name="Speech to text service"
                                AutomationProperties.HelpText="Choose the transcription service to use." />

                            <Button
                                x:Name="BtnSpeechToText"
                                Click="BtnSpeechToText_Click"
                                AccessKey="R"
                                MinWidth="160"
                                AutomationProperties.Name="Start or stop recording"
                                AutomationProperties.HelpText="Begin recording speech for transcription.">
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                    <FontIcon Glyph="&#xE7C8;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                    <TextBlock Text="Record" />
                                </StackPanel>
                                <ToolTipService.ToolTip>
                                    <ToolTip Content="Start or stop recording (Alt+R)" />
                                </ToolTipService.ToolTip>
                            </Button>

                            <TextBox
                                x:Name="TxtSpeechToText"
                                Header="Transcript"
                                AcceptsReturn="True"
                                MinHeight="120"
                                PlaceholderText="Live speech-to-text output appears here."
                                TextWrapping="Wrap"
                                TextChanged="TxtSpeechToText_TextChanged"
                                AutomationProperties.Name="Speech to text transcript"
                                AutomationProperties.HelpText="Review the text captured from your microphone." />
                        </StackPanel>
                    </Border>

                    <Border
                        x:Name="FormattingPanel"
                        Grid.Row="0"
                        Grid.Column="1"
                        Style="{StaticResource CardBorderStyle}">
                        <Border.Transitions>
                            <TransitionCollection>
                                <EntranceThemeTransition />
                            </TransitionCollection>
                        </Border.Transitions>
                        <StackPanel Spacing="16">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <FontIcon Glyph="&#xE8D2;" FontSize="24" Foreground="{StaticResource PrimaryBrush}" />
                                <StackPanel>
                                    <TextBlock Text="Formatting" Style="{StaticResource SectionHeaderTextStyle}" />
                                    <TextBlock Text="Prepare transcripts for third-party tools." Style="{StaticResource SubHeaderTextStyle}" />
                                </StackPanel>
                            </StackPanel>

                            <ComboBox
                                x:Name="CmbInsertOption"
                                Header="Third-party interaction"
                                PlaceholderText="Select an action"
                                SelectionChanged="CmbInsertOption_SelectionChanged"
                                AutomationProperties.Name="Third party application interaction"
                                AutomationProperties.HelpText="Choose how to send formatted text to another application." />

                            <TextBox
                                x:Name="TxtFormatPrompt"
                                Header="Formatting prompt"
                                AcceptsReturn="True"
                                MinHeight="80"
                                PlaceholderText="Describe how the transcript should be formatted."
                                TextWrapping="Wrap"
                                AutomationProperties.Name="Formatting prompt"
                                AutomationProperties.HelpText="Provide instructions for formatting the transcript." />

                            <muxc:WrapPanel Spacing="12">
                                <Button
                                    x:Name="BtnFormatTranscript"
                                    Click="BtnFormatTranscript_Click"
                                    AccessKey="F"
                                    MinWidth="160"
                                    AutomationProperties.Name="Format transcript"
                                    AutomationProperties.HelpText="Apply formatting to the transcript using your prompt.">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE8A5;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="Format" />
                                    </StackPanel>
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Format transcript locally (Alt+F)" />
                                    </ToolTipService.ToolTip>
                                </Button>

                                <Button
                                    x:Name="BtnFormatLlm"
                                    Click="BtnFormatLlm_Click"
                                    AccessKey="L"
                                    MinWidth="160"
                                    AutomationProperties.Name="Format transcript with language model"
                                    AutomationProperties.HelpText="Send the transcript and prompt to an AI service for formatting.">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE943;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="Format with AI" />
                                    </StackPanel>
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Format transcript with AI assistance (Alt+L)" />
                                    </ToolTipService.ToolTip>
                                </Button>
                            </muxc:WrapPanel>

                            <TextBox
                                x:Name="TxtFormatTranscript"
                                Header="Formatted output"
                                AcceptsReturn="True"
                                MinHeight="120"
                                PlaceholderText="Formatted transcript will appear here."
                                TextWrapping="Wrap"
                                AutomationProperties.Name="Formatted transcript"
                                AutomationProperties.HelpText="Review the formatted version of the transcript." />
                        </StackPanel>
                    </Border>

                    <Border
                        x:Name="UtilitiesPanel"
                        Grid.Row="1"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Style="{StaticResource CardBorderStyle}">
                        <Border.Transitions>
                            <TransitionCollection>
                                <EntranceThemeTransition />
                            </TransitionCollection>
                        </Border.Transitions>
                        <StackPanel Spacing="16">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <FontIcon Glyph="&#xE722;" FontSize="24" Foreground="{StaticResource PrimaryBrush}" />
                                <StackPanel>
                                    <TextBlock Text="Utilities" Style="{StaticResource SectionHeaderTextStyle}" />
                                    <TextBlock Text="Capture screenshots, run OCR, and play back text." Style="{StaticResource SubHeaderTextStyle}" />
                                </StackPanel>
                            </StackPanel>

                            <muxc:WrapPanel Spacing="12">
                                <Button
                                    x:Name="BtnScreenshot"
                                    Click="BtnScreenshot_Click"
                                    AccessKey="S"
                                    MinWidth="160"
                                    AutomationProperties.Name="Capture screenshot to clipboard"
                                    AutomationProperties.HelpText="Capture the current screen and copy it to the clipboard.">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE114;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="Screenshot" />
                                    </StackPanel>
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Screenshot to clipboard (Alt+S)" />
                                    </ToolTipService.ToolTip>
                                </Button>

                                <Button
                                    x:Name="BtnScreenshotOcr"
                                    Click="BtnScreenshotOcr_Click"
                                    AccessKey="O"
                                    MinWidth="160"
                                    AutomationProperties.Name="Capture screenshot and run OCR"
                                    AutomationProperties.HelpText="Capture the screen, extract text, and copy it to the clipboard.">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE8A7;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="Screenshot &amp; OCR" />
                                    </StackPanel>
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Screenshot and run OCR (Alt+O)" />
                                    </ToolTipService.ToolTip>
                                </Button>

                                <Button
                                    x:Name="BtnOcrClipboard"
                                    Click="BtnOcrClipboard_Click"
                                    AccessKey="C"
                                    MinWidth="160"
                                    AutomationProperties.Name="Run OCR on clipboard image"
                                    AutomationProperties.HelpText="Extract text from the image currently on the clipboard.">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE8D4;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="OCR clipboard" />
                                    </StackPanel>
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Run OCR on clipboard (Alt+C)" />
                                    </ToolTipService.ToolTip>
                                </Button>
                            </muxc:WrapPanel>

                            <TextBox
                                x:Name="TxtOcr"
                                Header="OCR result"
                                AcceptsReturn="True"
                                MinHeight="120"
                                PlaceholderText="Extracted text appears here after OCR."
                                TextWrapping="Wrap"
                                AutomationProperties.Name="OCR result"
                                AutomationProperties.HelpText="Review the text captured by optical character recognition." />

                            <TextBox
                                x:Name="TxtClipboard"
                                Header="Clipboard text"
                                PlaceholderText="Paste or review clipboard text"
                                AutomationProperties.Name="Clipboard text"
                                AutomationProperties.HelpText="Review and edit the text currently in your clipboard." />

                            <muxc:WrapPanel Spacing="12">
                                <Button
                                    Click="CopyText_Click"
                                    AccessKey="P"
                                    MinWidth="160"
                                    AutomationProperties.Name="Copy text to clipboard"
                                    AutomationProperties.HelpText="Copy the clipboard text box content to your clipboard again.">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE8C8;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="Copy text" />
                                    </StackPanel>
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Copy the clipboard text (Alt+P)" />
                                    </ToolTipService.ToolTip>
                                </Button>

                                <Button
                                    x:Name="BtnTextToSpeech"
                                    Click="BtnTextToSpeech_Click"
                                    AccessKey="T"
                                    MinWidth="160"
                                    AutomationProperties.Name="Speak clipboard text"
                                    AutomationProperties.HelpText="Read the clipboard text aloud using text-to-speech.">
                                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                        <FontIcon Glyph="&#xE15D;" FontSize="18" FontFamily="Segoe Fluent Icons" />
                                        <TextBlock Text="Speak clipboard" />
                                    </StackPanel>
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Speak the clipboard text (Alt+T)" />
                                    </ToolTipService.ToolTip>
                                </Button>
                            </muxc:WrapPanel>
                        </StackPanel>
                    </Border>

                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="AdaptiveStates">
                            <VisualState x:Name="NarrowState">
                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="0" />
                                </VisualState.StateTriggers>
                                <VisualState.Setters>
                                    <Setter Target="FormattingPanel.(Grid.Row)" Value="1" />
                                    <Setter Target="FormattingPanel.(Grid.Column)" Value="0" />
                                    <Setter Target="FormattingPanel.(Grid.ColumnSpan)" Value="2" />
                                    <Setter Target="UtilitiesPanel.(Grid.Row)" Value="2" />
                                    <Setter Target="UtilitiesPanel.(Grid.Column)" Value="0" />
                                    <Setter Target="UtilitiesPanel.(Grid.ColumnSpan)" Value="2" />
                                </VisualState.Setters>
                            </VisualState>
                            <VisualState x:Name="WideState">
                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="960" />
                                </VisualState.StateTriggers>
                                <VisualState.Setters>
                                    <Setter Target="FormattingPanel.(Grid.Row)" Value="0" />
                                    <Setter Target="FormattingPanel.(Grid.Column)" Value="1" />
                                    <Setter Target="FormattingPanel.(Grid.ColumnSpan)" Value="1" />
                                    <Setter Target="UtilitiesPanel.(Grid.Row)" Value="1" />
                                    <Setter Target="UtilitiesPanel.(Grid.Column)" Value="0" />
                                    <Setter Target="UtilitiesPanel.(Grid.ColumnSpan)" Value="2" />
                                </VisualState.Setters>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                </Grid>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
